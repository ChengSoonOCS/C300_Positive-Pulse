<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Silkscreen:wght@400&display=swap" rel="stylesheet">
    <title>+Pulse</title>

<style>
    body {
        font-family: 'Silkscreen', monospace;
    }
    
    .detail-label {
        font-size: 0.9rem;
        color: #6c757d;
        margin-bottom: 0.5rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .detail-content {
        font-size: 1.1rem;
        color: #333;
        font-weight: 500;
    }

    .message-content {
        background: #f8f9fa;
        border-radius: 1rem;
        font-size: 1.1rem;
        line-height: 1.6;
        color: #333;
        border: 1px solid #e9ecef;
    }

    .status-badge {
        display: inline-block;
        padding: 0.5rem 1.2rem;
        border-radius: 1rem;
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: capitalize;
        min-width: 120px;
        text-align: center;
    }

    .status-pending {
        background: #fff3cd;
        color: #856404;
    }

    .status-in-progress {
        background: #cce5ff;
        color: #004085;
    }

    .status-resolved {
        background: #d4edda;
        color: #155724;
    }

    .btn-outline-primary {
        border-color: #d52323;
        color: #d52323;
    }

    .btn-outline-primary:hover {
        background: #d52323;
        color: #fff;
        border-color: #d52323;
    }

    .btn-primary {
        background: linear-gradient(90deg, #d52323 0%, #7024ab 100%);
        border: none;
    }

    .btn-primary:hover {
        background: linear-gradient(90deg, #c01f1f 0%, #631d99 100%);
    }

    .actions-group {
        border-top: 1px solid #e9ecef;
        padding-top: 1.5rem;
    }

    .form-select:focus {
        border-color: #d52323;
        box-shadow: 0 0 0 0.25rem rgba(213, 35, 35, 0.25);
    }
    .attachment-preview {
        max-height: 400px;
        width: auto;
        display: block;
        margin: 0 auto;
        object-fit: contain;
    }

    .document-preview {
        text-align: center;
        padding: 2rem;
    }

    .attachment-content {
        border: 1px solid #e9ecef;
    }
</style>
<%- include('partials/navbar') %>

<div class="container mt-5 mb-5">
    <div class="card shadow-lg">
        <div class="card-header d-flex justify-content-between align-items-center" 
            style="background: linear-gradient(90deg, #d52323 0%, #7024ab 100%);">
            <h3 class="mb-0 text-white">Feedback Details</h3>
            <a href="/admin/dashboard" class="btn btn-light">
                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
            </a>
        </div>
        <div class="card-body p-4">
            <div class="row g-4">
                <!-- Left Column -->
                <div class="col-md-6">
                    <div class="detail-group">
                        <label class="detail-label">Submitted by</label>
                        <div class="detail-content">
                            <i class="fas fa-user me-2"></i>
                            <%= feedback.userName %>
                        </div>
                    </div>
                    
                    <div class="detail-group mt-4">
                        <label class="detail-label">Category</label>
                        <div class="detail-content">
                            <i class="fas fa-tag me-2"></i>
                            <%= feedback.category %>
                        </div>
                    </div>
                </div>
                
                <!-- Right Column -->
                <div class="col-md-6">
                    <div class="detail-group">
                        <label class="detail-label">Date Submitted</label>
                        <div class="detail-content">
                            <i class="fas fa-calendar me-2"></i>
                            <%= new Date(feedback.submittedAt).toLocaleDateString() %>
                        </div>
                    </div>
                    
                    <div class="detail-group mt-4">
                        <label class="detail-label">Status</label>
                        <div class="detail-content">
                            <span class="status-badge status-<%= feedback.status.toLowerCase() %>">
                                <%= feedback.status %>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Message Section -->
                <div class="col-12 mt-4">
                    <div class="detail-group">
                        <label class="detail-label">Message</label>
                        <div class="message-content p-4">
                            <%= feedback.message %>
                        </div>
                    </div>
                </div>

                
<% if (feedback.attachmentUrl) { %>
<div class="col-12 mt-4">
    <div class="detail-group">
        <label class="detail-label">Attachment</label>
        <div class="attachment-content p-3 bg-light rounded">
            <% 
            const fileExt = feedback.attachmentUrl.split('.').pop().toLowerCase();
            const isImage = ['jpg', 'jpeg', 'png', 'gif'].includes(fileExt);
            %>

            <% if (isImage) { %>
                <img src="/images/<%= feedback.attachmentUrl %>" 
                    class="img-fluid rounded attachment-preview" 
                    alt="Feedback attachment">
            <% } else { %>
                <div class="document-preview">
                    <i class="fas fa-file-alt fa-3x text-secondary"></i>
                    <p class="mt-2 mb-0 text-secondary">
                        <%= feedback.attachmentUrl %>
                    </p>
                    <a href="/images/<%= feedback.attachmentUrl %>" 
                    class="btn btn-sm btn-outline-primary mt-2" 
                    target="_blank">
                        Download File
                    </a>
                </div>
            <% } %>
        </div>
    </div>
</div>
<% } %>

                <!-- Actions Section -->
                <div class="col-12 mt-4">
                    <div class="actions-group d-flex gap-3">
                        <form action="/admin/feedback/<%= feedback.feedbackId %>/status" method="POST">
                            <div class="d-flex gap-2">
                                <select name="status" class="form-select" required>
                                    <option value="">Update Status</option>
                                    <option value="pending" <%= feedback.status === 'pending' ? 'selected' : '' %>>Pending</option>
                                    <option value="in-progress" <%= feedback.status === 'in-progress' ? 'selected' : '' %>>In Progress</option>
                                    <option value="resolved" <%= feedback.status === 'resolved' ? 'selected' : '' %>>Resolved</option>
                                </select>
                                <button type="submit" class="btn btn-primary">Update</button>
                            </div>
                        </form>
                        <form action="/admin/feedback/<%= feedback.feedbackId %>" method="POST" 
                            onsubmit="return confirm('Are you sure you want to delete this feedback?');">
                            <input type="hidden" name="_method" value="DELETE">
                            <button type="submit" class="btn btn-danger">Delete Feedback</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<%- include('partials/footer') %>

</head>
</html>

